<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IoT Health Dashboard</title>
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <script>
    function toggleSidebar() {
      document
        .getElementById('sidebar')
        .classList.toggle('-translate-x-full');
    }

    // Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ notification Î³Î¹Î± 3â€³
    function showNotification(message) {
      const notif = document.getElementById('notification');
      notif.textContent = message;
      notif.classList.remove('hidden');
      setTimeout(() => {
        notif.classList.add('hidden');
      }, 5000);
    }
	
	  // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· loader
  function showLoader() {
    document.getElementById('loader').classList.remove('hidden');
  }
  // Î‘Ï€ÏŒÎºÏÏ…ÏˆÎ· loader
  function hideLoader() {
    document.getElementById('loader').classList.add('hidden');
  }

    // Î ÎµÏÎ¹Î³ÏÎ±Ï†Î­Ï‚ Î±Î½Î¬ Î±Î¹ÏƒÎ¸Î·Ï„Î®ÏÎ±
    const sensorDescriptions = {
      'MCP9808':  'Î˜ÎµÏÎ¼Î¿ÎºÏÎ±ÏƒÎ¯Î± Î£ÏÎ¼Î±Ï„Î¿Ï‚',
      'ECG':      'Î—Î»ÎµÎºÏ„ÏÎ¿ÎºÎ±ÏÎ´Î¹Î¿Î³ÏÎ¬Ï†Î·Î¼Î±',
      'MAX30102': 'ÎšÎ¿ÏÎµÏƒÎ¼ÏŒÏ‚ ÎŸÎ¾Ï…Î³ÏŒÎ½Î¿Ï… Spo2'
    };

  function runSensor(name, endpoint) {
  // 1) Î±ÏÏ‡Î¹ÎºÎ® ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ·
  showNotification(
    "Î— Î¼Î­Ï„ÏÎ·ÏƒÎ· Î¾ÎµÎºÎ¯Î½Î·ÏƒÎµ! Î Î±ÏÎ±ÎºÎ±Î»Ï Ï€ÎµÏÎ¹Î¼Î­Î½ÎµÏ„Îµ Î¼Î­Ï‡ÏÎ¹ Î½Î± Î»Î¬Î²ÎµÏ„Îµ ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·Ï‚."
  );

  // 2) ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ· spinner
  showLoader();

  // 3) ÎºÎ¬Î½Î¿Ï…Î¼Îµ Ï„Î¿ POST
  fetch(endpoint, { method: 'POST' })
    .then(response => {
      // 4) ÎºÏÏÎ²Î¿Ï…Î¼Îµ loader
      hideLoader();

      if (response.ok) {
        const desc = sensorDescriptions[name] || '';
        showNotification(
          `Î— Î¼Î­Ï„ÏÎ·ÏƒÎ· Î³Î¹Î± Ï„Î¿Î½ Î±Î¹ÏƒÎ¸Î·Ï„Î®ÏÎ± ${name} Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ! (${desc})`
        );
      } else {
        showNotification(`Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î· Î¼Î­Ï„ÏÎ·ÏƒÎ· ${name}`);
      }
    })
    .catch(() => {
      hideLoader();
      showNotification(`Î£Ï†Î¬Î»Î¼Î± Î´Î¹ÎºÏ„ÏÎ¿Ï… Î³Î¹Î± ${name}`);
    });
}

  </script>
</head>

<body class="bg-gray-100">

<style>
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  .spinner {
    width: 4rem;
    height: 4rem;
    border-radius: 50%;
    border: 8px dashed #e2e8f0;
    border-top: 8px solid #3b82f6;
    animation: spin 1s linear infinite;
  }
</style>



  <!-- Notification -->
  <div id="notification"
       class="fixed top-4 inset-x-0 mx-auto bg-green-500 text-white text-center py-2 px-4 rounded hidden z-50">
  </div>
  
<!-- Loader -->
<div
  id="loader"
  class="fixed inset-0 flex justify-center items-center bg-black bg-opacity-25 hidden z-50"
>
  <div class="spinner"></div>
</div>


 <!-- Custom Styles -->
  <link
    rel="stylesheet"
    href="{{ url_for('static', filename='css/styles.css') }}"
  />
  <!-- Sidebar toggle script -->
  <script defer src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</head>
<body>

    <!-- Menu Toggle Button -->
    <button id="toggleSidebar" class="text-white fixed top-2 left-2 z-30 bg-opal-dark rounded p-2" onclick="toggleSidebar && toggleSidebar()">
        <span>â˜°</span>
    </button>
    <!-- Sidebar -->
<aside
  id="sidebar"
  class="fixed inset-y-0 left-0 z-40 w-56 bg-gray-800 text-white p-4
         transform -translate-x-full transition-transform duration-200
         md:translate-x-0 overflow-y-auto pt-16"
>
  <nav class="flex flex-col space-y-2 px-4">
    <a href="/"            class="block bg-opal-light hover:bg-gray-700 p-2 rounded">Home</a>
    <a href="/temperature" class="block hover:bg-gray-700 p-2 rounded">Temperature</a>
	<a href="/spo2"         class="block hover:bg-gray-700 p-2 rounded">SpOâ‚‚</a>
    <a href="/ecg"        class="block hover:bg-gray-700 p-2 rounded">ECG</a>
	<a href="/qa"         class="block hover:bg-gray-700 p-2 rounded">AI MediTaker</a>
	<a href="/about"          class="block hover:bg-gray-700 p-2 rounded">About us</a>

  </nav>
</aside>

  <!-- Main Content -->
  <main id="main" class="md:ml-56 pl-16 p-6" class="md:ml-56 pl-16 p-6">
    <h1 class="text-3xl font-bold text-gray-800 mb-4">
      Welcome to IoT Health Dashboard
    </h1>
    <p class="text-gray-600 mb-8">
      Select a measurement from the sidebar to view data.
    </p>

    <section class="flex flex-col items-center">
      <p class="text-lg font-semibold mb-4">
        Pick a sensor to start measurements.
      </p>
      <div class="relative w-full max-w-xs sm:max-w-sm md:max-w-md">
        <svg viewBox="-50 0 260 220" xmlns="http://www.w3.org/2000/svg" class="w-full">
          <!-- Humanoid figure -->
          <g stroke="black" stroke-width="2" fill="none">
            <circle cx="60" cy="20" r="12" />
            <rect x="45" y="34" width="30" height="50" rx="15" />
            <rect x="30" y="40" width="12" height="45" rx="6" />
            <rect x="78" y="40" width="12" height="45" rx="6" />
            <rect x="48" y="84" width="12" height="45" rx="6" />
            <rect x="60" y="84" width="12" height="45" rx="6" />
          </g>

          <!-- MCP9808 sensor (red) -->
          <circle cx="40" cy="58" r="4" fill="#EF4444" />
          <line x1="40" y1="58" x2="-15" y2="110" stroke="#EF4444" stroke-width="2"/>

          <!-- ECG electrodes (purple) -->
          <circle cx="45" cy="38" r="4" fill="#6366F1" />
          <circle cx="75" cy="38" r="4" fill="#6366F1" />
          <circle cx="74" cy="74" r="4" fill="#6366F1" />
          <line x1="45" y1="38" x2="147" y2="57" stroke="#6366F1" stroke-width="2"/>
          <line x1="75" y1="38" x2="147" y2="57" stroke="#6366F1" stroke-width="2"/>
          <line x1="74" y1="74" x2="147" y2="57" stroke="#6366F1" stroke-width="2"/>

          <!-- MAX30102 sensor (green) -->
          <circle cx="86" cy="84" r="4" fill="#10B981" />
          <line x1="86" y1="84" x2="162" y2="145" stroke="#10B981" stroke-width="2"/>
        </svg>

        <!-- Sensor Buttons -->
        <button
          type="button"
          onclick="runSensor('MCP9808', '/run_mcp9808')"
          class="absolute bg-red-600 text-white text-xs px-2 py-1 rounded"
          style="top:49%; left:8%;">MCP9808</button>

        <button
          type="button"
          onclick="runSensor('ECG', '/run_ecg')"
          class="absolute bg-indigo-600 text-white text-xs px-2 py-1 rounded"
          style="top:20%; left:75%;">ECG</button>

        <button
          type="button"
          onclick="runSensor('MAX30102', '/run_max30102')"
          class="absolute bg-green-600 text-white text-xs px-2 py-1 rounded"
          style="top:66%; left:75%;">MAX30102</button>
      </div>
    </section>
  </main>

<!-- Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Ï„Î¿Ï… ÎµÎ¾Ï‰Ï„ÎµÏÎ¹ÎºÎ¿Ï JS Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Ï„Î¿ toggleSidebar, Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ static/js/ -->
<script defer src="{{ url_for('static', filename='js/scripts.js') }}"></script>

<!-- Shutdown Button (Bottom Right) -->
<form id="shutdownForm" action="/shutdown" method="POST" class="fixed bottom-6 right-6 z-50">
  <button
    type="button"
    onclick="confirmShutdown()"
    class="bg-red-600 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-xl shadow-lg"
  >
    ğŸ”´ ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿ Raspberry
  </button>
</form>

<script>
  function confirmShutdown() {
    if (confirm("Î•Î¯ÏƒÏ„Îµ ÏƒÎ¯Î³Î¿Ï…ÏÎ¿Î¹ ÏŒÏ„Î¹ Î¸Î­Î»ÎµÏ„Îµ Î½Î± ÎºÎ»ÎµÎ¯ÏƒÎµÏ„Îµ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±;")) {
      fetch('/shutdown', { method: 'POST' })
        .then(() => {
          alert("Î¤Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± ÎºÎ»ÎµÎ¯Î½ÎµÎ¹...");
        });
    }
  }
</script>



</body>
</html>
